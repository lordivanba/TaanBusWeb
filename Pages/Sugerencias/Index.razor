@page "/sugerencias"

<PageTitle>Portal sugerencias</PageTitle>

@using taanbus.Data.Models
@using System.Net.Http
@using System.Net.Http.Json
@inject HttpClient http
@inject NavigationManager nav


<h3 class="display-6">Portal de sugerencias</h3>
<hr>
<p class="w-75 lead ">Aquí podrás dejar tu opinión al respecto del transporte público y los paraderos que estos utilizan
    ya que todos
    tenemos ideas al respecto de como este servicio se puede mejorar. Se necesita utilizar los recursos tecnológicos
    para obetenr más gente, opiniónes además las personas tienen mucha creatividad, esta se puede implementar en el
    servicio.</p>
<h4>Objetivo</h4>
<p class="w-75 lead">Nosotros deseamos que nuestras voces sean escuchadas, el transporte público genera muchos ingresos
    y estos se pueden
    seguir invirtiendo para el beneficio de todos, por lo cuál buscamos más ideas innovadoras para que todos podamos
    disfrutar con mejor calidad el transporte y sus paraderos, queremos alzar nuestra voz por un medio digital actual..
</p>
<div class="button_">
    <a class="btn btn-success" href="sugerencia/form">Presentar sugerencia</a>
</div>

<div class="shadow p-3 mb-5 bg-body rounded w-100 mt-4">
    <h4>Sugerencias registradas</h4>
    @if (sugerencias != null)
    {
        <table class="mytable table">
            <thead>
                <tr>
                    <th scope="col">ID</th>
                    <th scope="col">Ciudadano</th>
                    <th scope="col">Descripcion</th>
                    <th scope="col">Fecha de registro</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var sugerencia in sugerencias)
                {
                    <tr>
                        <td scope="col">@sugerencia.Id</td>
                        <td scope="col">@sugerencia.NombreCiudadano @sugerencia.ApellidosCiudadano</td>
                        <td scope="col">@sugerencia.Descripcion</td>
                        <td scope="col">@sugerencia.FechaRegistro</td>
                        <td scope="col">
                            <button class="btn btn-outline-dark" @onclick="() => showSugerencia(sugerencia.Id)"><i><img
                                src="https://img.icons8.com/material-outlined/24/000000/edit--v1.png" /></i></button>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    }
    else
    {
        <p><em>Cargando...</em></p>
    }
</div>

@code {
    private readonly string api = "api/sugerencia";
    private IList<SugerenciaModel>? sugerencias;

    protected override async Task OnInitializedAsync()
    {
        sugerencias = await http.GetFromJsonAsync<IList<SugerenciaModel>>(api);
    }
    void showSugerencia(int id)
    {
        nav.NavigateTo($"sugerencia/{id}");
    }

}